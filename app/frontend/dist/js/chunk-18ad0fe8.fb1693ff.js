(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-18ad0fe8"],{"2baa":function(t,e,r){"use strict";t.exports=function(t,e){var r="function"==typeof Iterator&&Iterator.prototype[t];if(r)try{r.call({next:null},e).next()}catch(s){return!0}}},4754:function(t,e,r){"use strict";t.exports=function(t,e){return{value:t,done:e}}},6964:function(t,e,r){"use strict";var s=r("cb2d");t.exports=function(t,e,r){for(var i in e)s(t,i,e[i],r);return t}},"9bdd":function(t,e,r){"use strict";var s=r("825a"),i=r("2a62");t.exports=function(t,e,r,a){try{return a?e(s(r)[0],r[1]):e(r)}catch(o){i(t,"throw",o)}}},"9d08":function(t,e,r){"use strict";r("c662")},ab43:function(t,e,r){"use strict";var s=r("23e7"),i=r("c65b"),a=r("59ed"),o=r("825a"),n=r("46c4"),c=r("c5cc"),l=r("9bdd"),p=r("2a62"),d=r("2baa"),_=r("f99f"),u=r("c430"),h=!u&&!d("map",(function(){})),v=!u&&!h&&_("map",TypeError),f=u||h||v,w=c((function(){var t=this.iterator,e=o(i(this.next,t)),r=this.done=!!e.done;if(!r)return l(t,this.mapper,[e.value,this.counter++],!0)}));s({target:"Iterator",proto:!0,real:!0,forced:f},{map:function(t){o(this);try{a(t)}catch(e){p(this,"throw",e)}return v?i(v,this,t):new w(n(this),{mapper:t})}})},b64e:function(t,e,r){"use strict";var s=r("2a62");t.exports=function(t,e,r){for(var i=t.length-1;i>=0;i--)if(void 0!==t[i])try{r=s(t[i].iterator,e,r)}catch(a){e="throw",r=a}if("throw"===e)throw r;return r}},c5cc:function(t,e,r){"use strict";var s=r("c65b"),i=r("7c73"),a=r("9112"),o=r("6964"),n=r("b622"),c=r("69f3"),l=r("dc4a"),p=r("ae93").IteratorPrototype,d=r("4754"),_=r("2a62"),u=r("b64e"),h=n("toStringTag"),v="IteratorHelper",f="WrapForValidIterator",w="normal",m="throw",b=c.set,g=function(t){var e=c.getterFor(t?f:v);return o(i(p),{next:function(){var r=e(this);if(t)return r.nextHandler();if(r.done)return d(void 0,!0);try{var s=r.nextHandler();return r.returnHandlerResult?s:d(s,r.done)}catch(i){throw r.done=!0,i}},return:function(){var r=e(this),i=r.iterator;if(r.done=!0,t){var a=l(i,"return");return a?s(a,i):d(void 0,!0)}if(r.inner)try{_(r.inner.iterator,w)}catch(o){return _(i,m,o)}if(r.openIters)try{u(r.openIters,w)}catch(o){return _(i,m,o)}return i&&_(i,w),d(void 0,!0)}})},C=g(!0),$=g(!1);a($,h,"Iterator Helper"),t.exports=function(t,e,r){var s=function(s,i){i?(i.iterator=s.iterator,i.next=s.next):i=s,i.type=e?f:v,i.returnHandlerResult=!!r,i.nextHandler=t,i.counter=0,i.done=!1,b(this,i)};return s.prototype=e?C:$,s}},c662:function(t,e,r){},e022:function(t,e,r){"use strict";r.r(e);r("14d9"),r("e9f5"),r("ab43");var s=function(){var t=this,e=t._self._c;return e("div",[t.results?e("div",[t.grep_keyword("STALKERWARE","high")?e("div",{staticClass:"high-wrapper"},[e("div",{staticClass:"center"},[e("h1",{staticClass:"warning-title",domProps:{innerHTML:t._s(t.$t("report.stalkerware_msg"))}}),e("button",{staticClass:"btn btn-report-low-light",on:{click:function(e){return t.new_capture()}}},[t._v(t._s(t.$t("report.start_new_capture")))]),e("button",{staticClass:"btn btn-report-high",on:{click:function(e){t.show_report=!0,t.results=!1}}},[t._v(t._s(t.$t("report.show_full_report")))])])]):t.alerts.high.length>=1?e("div",{staticClass:"high-wrapper"},[e("div",{staticClass:"center"},[e("h1",{staticClass:"warning-title",domProps:{innerHTML:t._s(t.$t("report.high_msg",{nb:t.$i18n.messages[t.$i18n.locale].report.numbers[t.alerts.high.length]}))}}),e("button",{staticClass:"btn btn-report-low-light",on:{click:function(e){return t.new_capture()}}},[t._v(t._s(t.$t("report.start_new_capture")))]),e("button",{staticClass:"btn btn-report-high",on:{click:function(e){t.show_report=!0,t.results=!1}}},[t._v(t._s(t.$t("report.show_full_report")))])])]):t.alerts.moderate.length>=1?e("div",{staticClass:"med-wrapper"},[e("div",{staticClass:"center"},[e("h1",{staticClass:"warning-title",domProps:{innerHTML:t._s(t.$t("report.moderate_msg",{nb:t.$i18n.messages[t.$i18n.locale].report.numbers[t.alerts.moderate.length]}))}}),e("button",{staticClass:"btn btn-report-low-light",on:{click:function(e){return t.new_capture()}}},[t._v(t._s(t.$t("report.start_new_capture")))]),e("button",{staticClass:"btn btn-report-moderate",on:{click:function(e){t.show_report=!0,t.results=!1}}},[t._v(t._s(t.$t("report.show_full_report")))])])]):t.alerts.low.length>=1?e("div",{staticClass:"low-wrapper"},[e("div",{staticClass:"center"},[e("h1",{staticClass:"warning-title",domProps:{innerHTML:t._s(t.$t("report.low_msg",{nb:t.$i18n.messages[t.$i18n.locale].report.numbers[t.alerts.low.length]}))}}),e("button",{staticClass:"btn btn-report-low-light",on:{click:function(e){return t.new_capture()}}},[t._v(t._s(t.$t("report.start_new_capture")))]),e("button",{staticClass:"btn btn-report-low",on:{click:function(e){t.show_report=!0,t.results=!1}}},[t._v(t._s(t.$t("report.show_full_report")))])])]):e("div",{staticClass:"none-wrapper"},[e("div",{staticClass:"center"},[e("h1",{staticClass:"warning-title",domProps:{innerHTML:t._s(t.$t("report.fine_msg"))}}),e("button",{staticClass:"btn btn-report-low-light",on:{click:function(e){t.show_report=!0,t.results=!1}}},[t._v(t._s(t.$t("report.show_full_report")))]),e("button",{staticClass:"btn btn-report-low",on:{click:function(e){return t.new_capture()}}},[t._v(t._s(t.$t("report.start_new_capture")))])])])]):t.show_report?e("div",{staticClass:"wrapper"},[e("div",{staticClass:"report-wrapper"},[e("div",{staticClass:"device-ctx"},[e("h3",{staticStyle:{margin:"0","padding-left":"10px"}},[t._v(t._s(t.$t("report.report_of"))+" "+t._s(t.device.name))]),e("div",{staticClass:"device-ctx-legend"},[t._v(" "+t._s(t.$t("report.pcap_sha1"))+" "+t._s(t.pcap.SHA1)),e("br"),t._v(" "+t._s(t.$t("report.capture_started"))+" "+t._s(t.firstPacketTime)),e("br"),t._v(" "+t._s(t.$t("report.capture_ended"))+" "+t._s(t.lastPacketTime)),e("br"),t._v(" "+t._s(t.$t("report.detection_methods"))+" "+t._s(t.detection_methods)+" ")])]),t.alerts?e("div",[e("ul",{staticClass:"alerts"},[t._l(t.alerts.high,(function(r){return e("li",{key:r.message,staticClass:"alert"},[e("div",{staticClass:"alert-header"},[e("span",{staticClass:"high-label"},[t._v(t._s(t.$t("report.high")))]),e("span",{staticClass:"alert-id"},[t._v(t._s(r.id))]),e("span",{staticClass:"btn-whitelist",on:{click:function(e){return t.add_whitelist(r.host)}}},[t._v("Add to the whitelist")])]),e("div",{staticClass:"alert-body"},[e("span",{staticClass:"title"},[t._v(t._s(r.title))]),e("p",{staticClass:"description"},[t._v(t._s(r.description))])])])})),t._l(t.alerts.moderate,(function(r){return e("li",{key:r.message,staticClass:"alert"},[e("div",{staticClass:"alert-header"},[e("span",{staticClass:"moderate-label"},[t._v(t._s(t.$t("report.moderate")))]),e("span",{staticClass:"alert-id"},[t._v(t._s(r.id))]),e("span",{staticClass:"btn-whitelist",on:{click:function(e){return t.add_whitelist(r.host)}}},[t._v("Add to the whitelist")])]),e("div",{staticClass:"alert-body"},[e("span",{staticClass:"title"},[t._v(t._s(r.title))]),e("p",{staticClass:"description"},[t._v(t._s(r.description))])])])})),t._l(t.alerts.low,(function(r){return e("li",{key:r.message,staticClass:"alert"},[e("div",{staticClass:"alert-header"},[e("span",{staticClass:"moderate-label"},[t._v(t._s(t.$t("report.low")))]),e("span",{staticClass:"alert-id"},[t._v(t._s(r.id))]),e("span",{staticClass:"btn-whitelist",on:{click:function(e){return t.add_whitelist(r.host)}}},[t._v("Add to the whitelist")])]),e("div",{staticClass:"alert-body"},[e("span",{staticClass:"title"},[t._v(t._s(r.title))]),e("p",{staticClass:"description"},[t._v(t._s(r.description))])])])}))],2)]):e("div",{staticClass:"no-alerts-to-show"},[e("span",{staticClass:"main-text"},[t._v(t._s(t.$t("report.no_alerts_title")))]),e("br"),e("span",{staticClass:"second-text"},[t._v(t._s(t.$t("report.no_alerts_subtext")))])]),t.uncategorized_records.length>0?e("h5",{staticClass:"title-report"},[t._v(t._s(t.$t("report.uncat_coms_table")))]):t._e(),t.uncategorized_records.length>0?e("div",[e("table",{staticClass:"table-uncat"},[e("thead",[e("tr",[e("td",[t._v(t._s(t.$t("report.protocol")))]),e("td",[t._v(t._s(t.$t("report.domain_name")))]),e("td",[t._v(t._s(t.$t("report.ip_address")))]),e("td",[t._v(t._s(t.$t("report.port")))])])]),t._l(t.uncategorized_records,(function(r){return e("tr",{key:r.ip_dst},[e("td",[t._v(t._s(Object.keys(r.protocols).map(t=>r.protocols[t].name).join(", ")))]),e("td",{on:{click:function(e){return t.add_whitelist(r.domains[0])}}},[t._v(t._s(r.domains.join(", ")))]),e("td",{on:{click:function(e){return t.add_whitelist(r.ip_dst)}}},[t._v(t._s(r.ip_dst))]),e("td",[t._v(t._s(Object.keys(r.protocols).map(t=>r.protocols[t].port).join(", ")))])])}))],2)]):t._e(),t.whitelisted_records.length>0?e("h5",{staticClass:"title-report"},[t._v(t._s(t.$t("report.whitelisted_coms_table")))]):t._e(),t.whitelisted_records.length>0?e("div",[e("table",{staticClass:"table-uncat"},[e("thead",[e("tr",[e("td",[t._v(t._s(t.$t("report.protocol")))]),e("td",[t._v(t._s(t.$t("report.domain_name")))]),e("td",[t._v(t._s(t.$t("report.ip_address")))]),e("td",[t._v(t._s(t.$t("report.port")))])])]),t._l(t.whitelisted_records,(function(r){return e("tr",{key:r.ip_dst},[e("td",[t._v(t._s(Object.keys(r.protocols).map(t=>r.protocols[t].name).join(", ")))]),e("td",[t._v(t._s(r.domains.join(", ")))]),e("td",[t._v(t._s(r.ip_dst))]),e("td",[t._v(t._s(Object.keys(r.protocols).map(t=>r.protocols[t].port).join(", ")))])])}))],2)]):t._e(),e("div",{attrs:{id:"controls-analysis"}},[e("div",{staticClass:"column col-6"},[e("button",{staticClass:"btn btn btn-primary width-100",on:{click:function(e){return t.save_capture()}}},[t._v(t._s(t.$t("report.save")))])]),e("div",{staticClass:"column col-6"},[e("button",{staticClass:"btn width-100",on:{click:function(e){return t.$router.push("generate-ap")}}},[t._v(t._s(t.$t("report.start_new_capture")))])])])])]):t._e()])},i=[],a=(r("f665"),r("7d54"),r("a18c")),o=r("bc3a"),n=r.n(o),c=r("56d7"),l={name:"report",data(){return{results:!0,detection_methods:"",uncategorized_records:[],whitelisted_records:[]}},props:{device:Object,methods:Object,pcap:Object,records:Array,alerts:Array,capture_token:String},computed:{firstPacketTime:function(){return this.extractPacketTime(["First packet time","Earliest packet time"])},lastPacketTime:function(){return this.extractPacketTime(["Last packet time","Latest packet time"])}},methods:{save_capture:function(){console.log("[report.vue] Saving the capture"),a["a"].replace({name:"save-capture",params:{capture_token:this.capture_token}})},new_capture:function(){console.log("[report.vue] Deleting the capture and creating a new AP"),n.a.get("/api/misc/delete-captures",{timeout:3e4}).then(()=>{a["a"].push({name:"generate-ap"})}).catch(t=>{console.log(t)})},grep_keyword:function(t,e){try{var r,s;return!!this.alerts[e].length&&(this.alerts[e].forEach(e=>{r=e.title.indexOf(t),s||(s=r>0)}),s)}catch(i){console.log(i)}},get_detection_methods:function(){this.detection_methods+=1==this.methods.iocs?`☑ ${this.$t("report.indicators")} `:`☐ ${this.$t("report.indicators")} `,this.detection_methods+=1==this.methods.heuristics?`☑ ${this.$t("report.heuristics")} `:`☐ ${this.$t("report.heuristics")} `,this.detection_methods+=1==this.methods.active?`☑ ${this.$t("report.active")} `:`☐ ${this.$t("report.active")} `},add_whitelist:function(t){c["EventBus"].$emit("showModal",{action:"whitelist",host:t})},get_records:function(){this.records.forEach(t=>{t.suspicious||t.whitelisted?t.whitelisted&&this.whitelisted_records.push(t):this.uncategorized_records.push(t)})},extractPacketTime:function(t){const e=t.map(t=>this.pcap?this.pcap[t]:void 0).find(t=>"string"===typeof t&&t.length>0);return e?e.split(",")[0]:""}},created:function(){console.log("[report.vue] Showing report.vue"),this.get_detection_methods(),this.get_records()}},p=l,d=(r("9d08"),r("2877")),_=Object(d["a"])(p,s,i,!1,null,null,null);e["default"]=_.exports},f665:function(t,e,r){"use strict";var s=r("23e7"),i=r("c65b"),a=r("2266"),o=r("59ed"),n=r("825a"),c=r("46c4"),l=r("2a62"),p=r("f99f"),d=p("find",TypeError);s({target:"Iterator",proto:!0,real:!0,forced:d},{find:function(t){n(this);try{o(t)}catch(s){l(this,"throw",s)}if(d)return i(d,this,t);var e=c(this),r=0;return a(e,(function(e,s){if(t(e,r++))return s(e)}),{IS_RECORD:!0,INTERRUPTED:!0}).result}})}}]);
//# sourceMappingURL=chunk-18ad0fe8.fb1693ff.js.map